<!-- Generated with Stardoc: http://skydoc.bazel.build -->

Module extensions.

<a id="node_modules"></a>

## node_modules

<pre>
node_modules = use_extension("@build_bazel_rules_nodejs//lib:extensions.bzl", "node_modules")
node_modules.yarn(<a href="#node_modules.yarn-name">name</a>, <a href="#node_modules.yarn-data">data</a>, <a href="#node_modules.yarn-args">args</a>, <a href="#node_modules.yarn-environment">environment</a>, <a href="#node_modules.yarn-exports_directories_only">exports_directories_only</a>, <a href="#node_modules.yarn-frozen_lockfile">frozen_lockfile</a>,
                  <a href="#node_modules.yarn-generate_local_modules_build_files">generate_local_modules_build_files</a>, <a href="#node_modules.yarn-host_node_bin">host_node_bin</a>, <a href="#node_modules.yarn-host_yarn_bin">host_yarn_bin</a>, <a href="#node_modules.yarn-included_files">included_files</a>,
                  <a href="#node_modules.yarn-links">links</a>, <a href="#node_modules.yarn-manual_build_file_contents">manual_build_file_contents</a>, <a href="#node_modules.yarn-package_json">package_json</a>, <a href="#node_modules.yarn-package_path">package_path</a>, <a href="#node_modules.yarn-patch_args">patch_args</a>,
                  <a href="#node_modules.yarn-patch_tool">patch_tool</a>, <a href="#node_modules.yarn-post_install_patches">post_install_patches</a>, <a href="#node_modules.yarn-pre_install_patches">pre_install_patches</a>, <a href="#node_modules.yarn-quiet">quiet</a>, <a href="#node_modules.yarn-strict_visibility">strict_visibility</a>,
                  <a href="#node_modules.yarn-symlink_node_modules">symlink_node_modules</a>, <a href="#node_modules.yarn-timeout">timeout</a>, <a href="#node_modules.yarn-use_global_yarn_cache">use_global_yarn_cache</a>, <a href="#node_modules.yarn-yarn_lock">yarn_lock</a>)
</pre>


**TAG CLASSES**

<a id="node_modules.yarn"></a>

### yarn

**Attributes**

| Name  | Description | Type | Mandatory | Default |
| :------------- | :------------- | :------------- | :------------- | :------------- |
| <a id="node_modules.yarn-name"></a>name |  -   | <a href="https://bazel.build/concepts/labels#target-names">Name</a> | required |  |
| <a id="node_modules.yarn-data"></a>data |  Data files required by this rule.<br><br>If symlink_node_modules is True, this attribute is optional since the package manager will run in your workspace folder. It is recommended, however, that all files that the package manager depends on, such as `.rc` files or files used in `postinstall`, are added symlink_node_modules is True so that the repository rule is rerun when any of these files change.<br><br>If symlink_node_modules is False, the package manager is run in the bazel external repository so all files that the package manager depends on must be listed.   | <a href="https://bazel.build/concepts/labels">List of labels</a> | optional |  `[]`  |
| <a id="node_modules.yarn-args"></a>args |  Arguments passed to yarn install.<br><br>See yarn CLI docs https://yarnpkg.com/en/docs/cli/install for complete list of supported arguments.   | List of strings | optional |  `[]`  |
| <a id="node_modules.yarn-environment"></a>environment |  Environment variables to set before calling the package manager.   | <a href="https://bazel.build/rules/lib/dict">Dictionary: String -> String</a> | optional |  `{}`  |
| <a id="node_modules.yarn-exports_directories_only"></a>exports_directories_only |  Export only top-level package directory artifacts from node_modules.<br><br>Turning this on will decrease the time it takes for Bazel to setup runfiles and sandboxing when there are a large number of npm dependencies as inputs to an action.<br><br>This breaks compatibility for labels that reference files within npm packages such as `@npm//:node_modules/prettier/bin-prettier.js`. To reference files within npm packages, you can use the `directory_file_path` rule and/or `DirectoryFilePathInfo` provider. Note, some rules still need upgrading to support consuming `DirectoryFilePathInfo` where needed.<br><br>NB: This feature requires runfiles be enabled due to an issue in Bazel which we are still investigating.     On Windows runfiles are off by default and must be enabled with the `--enable_runfiles` flag when     using this feature.<br><br>NB: `ts_library` does not support directory npm deps due to internal dependency on having all input sources files explicitly specified.<br><br>NB: `protractor_web_test` and `protractor_web_test_suite` do not support directory npm deps.<br><br>For the `nodejs_binary` & `nodejs_test` `entry_point` attribute (which often needs to reference a file within an npm package) you can set the entry_point to a dict with a single entry, where the key corresponds to the directory label and the value corresponds to the path within that directory to the entry point.<br><br>For example,<br><br><pre><code>nodejs_binary(&#10;    name = "prettier",&#10;    data = ["@npm//prettier"],&#10;    entry_point = "@npm//:node_modules/prettier/bin-prettier.js",&#10;)</code></pre><br><br>becomes,<br><br><pre><code>nodejs_binary(&#10;    name = "prettier",&#10;    data = ["@npm//prettier"],&#10;    entry_point = { "@npm//:node_modules/prettier": "bin-prettier.js" },&#10;)</code></pre><br><br>For labels that are passed to `$(rootpath)`, `$(execpath)`, or `$(location)` you can simply break these apart into the directory label that gets passed to the expander & path part to follows it.<br><br>For example,<br><br><pre><code>$(rootpath @npm//:node_modules/prettier/bin-prettier.js")</code></pre><br><br>becomes,<br><br><pre><code>$(rootpath @npm//:node_modules/prettier)/bin-prettier.js</code></pre>   | Boolean | optional |  `False`  |
| <a id="node_modules.yarn-frozen_lockfile"></a>frozen_lockfile |  Use the `--frozen-lockfile` flag for yarn.<br><br>Don't generate a `yarn.lock` lockfile and fail if an update is needed.<br><br>This flag enables an exact install of the version that is specified in the `yarn.lock` file. This helps to have reproducible builds across builds.<br><br>To update a dependency or install a new one run the `yarn install` command with the vendored yarn binary. `bazel run @nodejs//:yarn install`. You can pass the options like `bazel run @nodejs//:yarn install -- -D <dep-name>`.   | Boolean | optional |  `True`  |
| <a id="node_modules.yarn-generate_local_modules_build_files"></a>generate_local_modules_build_files |  Enables the BUILD files auto generation for local modules installed with `file:` (npm) or `link:` (yarn)<br><br>When using a monorepo it's common to have modules that we want to use locally and publish to an external package repository. This can be achieved using a `js_library` rule with a `package_name` attribute defined inside the local package `BUILD` file. However, if the project relies on the local package dependency with `file:` (npm) or `link:` (yarn) to be used outside Bazel, this could introduce a race condition with both `npm_install` or `yarn_install` rules.<br><br>In order to overcome it, a link could be created to the package `BUILD` file from the npm external Bazel repository (so we can use a local BUILD file instead of an auto generated one), which require us to set `generate_local_modules_build_files = False` and complete a last step which is writing the expected targets on that same `BUILD` file to be later used both by `npm_install` or `yarn_install` rules, which are: `<package_name__files>`, `<package_name__nested_node_modules>`, `<package_name__contents>`, `<package_name__typings>` and the last one just `<package_name>`. If you doubt what those targets should look like, check the generated `BUILD` file for a given node module.<br><br>When true, the rule will follow the default behaviour of auto generating BUILD files for each `node_module` at install time.<br><br>When False, the rule will not auto generate BUILD files for `node_modules` that are installed as symlinks for local modules.   | Boolean | optional |  `True`  |
| <a id="node_modules.yarn-host_node_bin"></a>host_node_bin |  -   | <a href="https://bazel.build/concepts/labels">Label</a> | required |  |
| <a id="node_modules.yarn-host_yarn_bin"></a>host_yarn_bin |  -   | <a href="https://bazel.build/concepts/labels">Label</a> | required |  |
| <a id="node_modules.yarn-included_files"></a>included_files |  List of file extensions to be included in the npm package targets.<br><br>NB: This option has no effect when exports_directories_only is True as all files are automatically included in the exported directory for each npm package.<br><br>For example, [".js", ".d.ts", ".proto", ".json", ""].<br><br>This option is useful to limit the number of files that are inputs to actions that depend on npm package targets. See https://github.com/bazelbuild/bazel/issues/5153.<br><br>If set to an empty list then all files are included in the package targets. If set to a list of extensions, only files with matching extensions are included in the package targets. An empty string in the list is a special string that denotes that files with no extensions such as `README` should be included in the package targets.<br><br>This attribute applies to both the coarse `@wksp//:node_modules` target as well as the fine grained targets such as `@wksp//foo`.   | List of strings | optional |  `[]`  |
| <a id="node_modules.yarn-links"></a>links |  Targets to link as npm packages.<br><br>A mapping of npm package names to bazel targets to linked into node_modules.<br><br>If `package_path` is also set, the bazel target will be linked to the node_modules at `package_path` along with other 3rd party npm packages from this rule.<br><br>For example,<br><br><pre><code>yarn_install(&#10;    name = "npm",&#10;    package_json = "//web:package.json",&#10;    yarn_lock = "//web:yarn.lock",&#10;    package_path = "web",&#10;    links = {&#10;        "@scope/target": "//some/scoped/target",&#10;        "target": "//some/target",&#10;    },&#10;)</code></pre><br><br>creates targets in the @npm external workspace that can be used by other rules which are linked into `web/node_modules` along side the 3rd party deps since the `project_path` is `web`.<br><br>The above links will create the targets,<br><br><pre><code>@npm//@scope/target&#10;@npm//target</code></pre><br><br>that can be referenced as `data` or `deps` by other rules such as `nodejs_binary` and `ts_project` and can be required as `@scope/target` and `target` with standard node_modules resolution at runtime,<br><br><pre><code>nodejs_binary(&#10;    name = "bin",&#10;    entry_point = "bin.js",&#10;    deps = [&#10;        "@npm//@scope/target",&#10;        "@npm//target"&#10;        "@npm//other/dep"&#10;    ],&#10;)&#10;&#10;ts_project(&#10;    name = "test",&#10;    srcs = [...],&#10;    deps = [&#10;        "@npm//@scope/target",&#10;        "@npm//target"&#10;        "@npm//other/dep"&#10;    ],&#10;)</code></pre>   | <a href="https://bazel.build/rules/lib/dict">Dictionary: String -> String</a> | optional |  `{}`  |
| <a id="node_modules.yarn-manual_build_file_contents"></a>manual_build_file_contents |  Experimental attribute that can be used to override the generated BUILD.bazel file and set its contents manually.<br><br>Can be used to work-around a bazel performance issue if the default `@wksp//:node_modules` target has too many files in it. See https://github.com/bazelbuild/bazel/issues/5153. If you are running into performance issues due to a large node_modules target it is recommended to switch to using fine grained npm dependencies.   | String | optional |  `""`  |
| <a id="node_modules.yarn-package_json"></a>package_json |  -   | <a href="https://bazel.build/concepts/labels">Label</a> | required |  |
| <a id="node_modules.yarn-package_path"></a>package_path |  If set, link the 3rd party node_modules dependencies under the package path specified.<br><br>In most cases, this should be the directory of the package.json file so that the linker links the node_modules in the same location they are found in the source tree. In a future release, this will default to the package.json directory. This is planned for 4.0: https://github.com/bazelbuild/rules_nodejs/issues/2451   | String | optional |  `""`  |
| <a id="node_modules.yarn-patch_args"></a>patch_args |  The arguments given to the patch tool. Defaults to -p0, however -p1 will usually be needed for patches generated by git. If multiple -p arguments are specified, the last one will take effect. If arguments other than -p are specified, Bazel will fall back to use patch command line tool instead of the Bazel-native patch implementation. When falling back to patch command line tool and patch_tool attribute is not specified, `patch` will be used.   | List of strings | optional |  `["-p0"]`  |
| <a id="node_modules.yarn-patch_tool"></a>patch_tool |  The patch(1) utility to use. If this is specified, Bazel will use the specifed patch tool instead of the Bazel-native patch implementation.   | String | optional |  `""`  |
| <a id="node_modules.yarn-post_install_patches"></a>post_install_patches |  Patch files to apply after running package manager.<br><br>This can be used to make changes to installed packages after the package manager runs.<br><br>File paths in patches should be relative to workspace root.<br><br>Use with caution when `symlink_node_modules` enabled as the patches will run in your workspace and will modify files in your workspace.<br><br>NB: If `symlink_node_modules` is enabled, the node_modules folder is re-used between executions of the     repository rule. Patches may be re-applied to files in this case and fail to apply. A marker file     `node_modules/.bazel-post-install-patches` is left in this mode when patches are applied. When the     marker file is detected, patch file failures are treated as WARNINGS. For this reason, it is recommended     to patch npm packages with an npm tool such as https://www.npmjs.com/package/patch-package when     `symlink_node_modules` is enabled which handles re-apply patching logic more robustly.   | <a href="https://bazel.build/concepts/labels">List of labels</a> | optional |  `[]`  |
| <a id="node_modules.yarn-pre_install_patches"></a>pre_install_patches |  Patch files to apply before running package manager.<br><br>This can be used to make changes to package.json or other data files passed in before running the package manager.<br><br>File paths in patches should be relative to workspace root.<br><br>Not supported with `symlink_node_modules` enabled.   | <a href="https://bazel.build/concepts/labels">List of labels</a> | optional |  `[]`  |
| <a id="node_modules.yarn-quiet"></a>quiet |  If stdout and stderr should be printed to the terminal.   | Boolean | optional |  `True`  |
| <a id="node_modules.yarn-strict_visibility"></a>strict_visibility |  Turn on stricter visibility for generated BUILD.bazel files<br><br>When enabled, only dependencies within the given `package.json` file are given public visibility. All transitive dependencies are given limited visibility, enforcing that all direct dependencies are listed in the `package.json` file.   | Boolean | optional |  `True`  |
| <a id="node_modules.yarn-symlink_node_modules"></a>symlink_node_modules |  Turn symlinking of node_modules on<br><br>This requires the use of Bazel 0.26.0 and the experimental managed_directories feature.<br><br>When true, the package manager will run in the package.json folder and the resulting node_modules folder will be symlinked into the external repository create by this rule.<br><br>When false, the package manager will run in the external repository created by this rule and any files other than the package.json file and the lock file that are required for it to run should be listed in the data attribute.   | Boolean | optional |  `True`  |
| <a id="node_modules.yarn-timeout"></a>timeout |  Maximum duration of the package manager execution in seconds.   | Integer | optional |  `3600`  |
| <a id="node_modules.yarn-use_global_yarn_cache"></a>use_global_yarn_cache |  Use the global yarn cache on the system.<br><br>The cache lets you avoid downloading packages multiple times. However, it can introduce non-hermeticity, and the yarn cache can have bugs.<br><br>Disabling this attribute causes every run of yarn to have a unique cache_directory.<br><br>If True, this rule will pass `--mutex network` to yarn to ensure that the global cache can be shared by parallelized yarn_install rules.<br><br>If False, this rule will pass `--cache-folder /path/to/external/repository/__yarn_cache` to yarn so that the local cache is contained within the external repository.   | Boolean | optional |  `True`  |
| <a id="node_modules.yarn-yarn_lock"></a>yarn_lock |  -   | <a href="https://bazel.build/concepts/labels">Label</a> | required |  |


<a id="nodejs"></a>

## nodejs

<pre>
nodejs = use_extension("@build_bazel_rules_nodejs//lib:extensions.bzl", "nodejs")
nodejs.download(<a href="#nodejs.download-node_version">node_version</a>, <a href="#nodejs.download-yarn_version">yarn_version</a>)
</pre>


**TAG CLASSES**

<a id="nodejs.download"></a>

### download

**Attributes**

| Name  | Description | Type | Mandatory | Default |
| :------------- | :------------- | :------------- | :------------- | :------------- |
| <a id="nodejs.download-node_version"></a>node_version |  -   | String | required |  |
| <a id="nodejs.download-yarn_version"></a>yarn_version |  -   | String | required |  |


